{% extends "layout.html" %}

{% block title %}
    Log In
{% endblock %}

{% block main %}
    <form action="/register" method="post" onsubmit="">
        <div class="form-group">
            <input autocomplete="off" autofocus class="form-control" 
            name="username" placeholder="Username" type="text"
            required 
            onchange="checkUser()">
        </div>
        <div class="form-group">
            <input class="form-control" name="password" placeholder="Password" 
            type="password" required>
        </div>
        <div class="form-group">
            <input class="form-control" name="confirmation" 
            placeholder="Confirmation" type="password" required>
        </div>
        <button class="btn btn-primary" type="submit">Register</button>
    </form>
    
    <script>
        function checkUser(){
            var input = document.querySelector('input');
            var value = input.value;
            $.get('/check?username='+value, function(data){
                var avail = JSON.parse(data);
                if (avail)
                {
                    //alert('avail', avail)
                    return true;
                }
                else 
                {
                    alert('Name already in use.');
                    input.value= '';
                    input.focus();
                    return false;
                }   
            });
        };
    </script>
{% endblock %}
